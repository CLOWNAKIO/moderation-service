import { useAppDispatch, useAppSelector } from "@/hooks";
import { logOut } from "@/store/auth";
import i18n from "@/locales/i18next";
import { useTranslation } from "react-i18next";
import { NavLink, useSearchParams } from "react-router-dom";

const langs = [
  {
    abbr: "en",
    native: "English",
  },
  {
    abbr: "ru",
    native: "Русский",
  },
];

const Navbar = () => {
  const { t } = useTranslation();

  const [searchParams, SetSearchParams] = useSearchParams();

  const dispatch = useAppDispatch();
  const auth = useAppSelector((state) => state.auth);

  const openSignInModal = () => {
    if (!searchParams.get("modal")) {
      SetSearchParams((prev) => prev + "&modal=auth");
    }
  };

  const openSettingsModal = () => {
    if (!searchParams.get("modal")) {
      SetSearchParams((prev) => prev + "&modal=settings");
    }
  };

  return (
    <nav className="navbar-container">
      <div className="navbar-content">
        <div className="navbar-router">
          <NavLink to="/" className="navbar-logo icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="90"
              height="50"
              viewBox="0 0 90 50"
              fill="none"
            >
              <g clipPath="url(#clip0_185_319)">
                <path
                  d="M42 50C56.3594 50 68 44.4036 68 37.5C68 30.5964 56.3594 25 42 25C27.6406 25 16 30.5964 16 37.5C16 44.4036 27.6406 50 42 50Z"
                  fill="black"
                />
                <path
                  d="M77.5 18H12.5C5.59644 18 0 23.5964 0 30.5C0 37.4036 5.59644 43 12.5 43H77.5C84.4036 43 90 37.4036 90 30.5C90 23.5964 84.4036 18 77.5 18Z"
                  fill="black"
                />
                <path
                  d="M52 11H26C18.8203 11 13 16.8203 13 24C13 31.1797 18.8203 37 26 37H52C59.1797 37 65 31.1797 65 24C65 16.8203 59.1797 11 52 11Z"
                  fill="black"
                />
                <path
                  d="M56 38C66.4934 38 75 29.4934 75 19C75 8.50659 66.4934 0 56 0C45.5066 0 37 8.50659 37 19C37 29.4934 45.5066 38 56 38Z"
                  fill="black"
                />
                <path
                  d="M13.388 39.264C12.084 39.264 10.98 39.012 10.076 38.508C9.17999 38.004 8.45599 37.336 7.90399 36.504C7.35999 35.664 6.96399 34.732 6.71599 33.708C6.46799 32.684 6.34399 31.648 6.34399 30.6C6.34399 29.608 6.46799 28.604 6.71599 27.588C6.97199 26.564 7.37599 25.624 7.92799 24.768C8.48799 23.904 9.21599 23.212 10.112 22.692C11.008 22.172 12.1 21.912 13.388 21.912C14.452 21.912 15.376 22.092 16.16 22.452C16.944 22.804 17.592 23.264 18.104 23.832C18.624 24.392 19.02 24.98 19.292 25.596L16.508 26.892C16.236 26.476 15.956 26.12 15.668 25.824C15.38 25.52 15.052 25.288 14.684 25.128C14.324 24.96 13.892 24.876 13.388 24.876C12.668 24.876 12.064 25.052 11.576 25.404C11.088 25.748 10.696 26.204 10.4 26.772C10.104 27.34 9.89199 27.96 9.76399 28.632C9.63599 29.304 9.57199 29.96 9.57199 30.6C9.57199 31.28 9.64399 31.956 9.78799 32.628C9.93199 33.3 10.16 33.912 10.472 34.464C10.784 35.016 11.18 35.46 11.66 35.796C12.14 36.124 12.716 36.288 13.388 36.288C14.108 36.288 14.712 36.088 15.2 35.688C15.696 35.28 16.136 34.76 16.52 34.128L19.364 35.196C19.004 35.972 18.552 36.668 18.008 37.284C17.464 37.9 16.812 38.384 16.052 38.736C15.292 39.088 14.404 39.264 13.388 39.264ZM22.1092 39V22.2H25.2172V35.988H33.3412V39H22.1092ZM42.3869 39.288C41.0429 39.288 39.9029 39.036 38.9669 38.532C38.0309 38.02 37.2749 37.344 36.6989 36.504C36.1309 35.656 35.7149 34.72 35.4509 33.696C35.1869 32.672 35.0549 31.64 35.0549 30.6C35.0549 29.56 35.1869 28.528 35.4509 27.504C35.7149 26.48 36.1309 25.548 36.6989 24.708C37.2749 23.86 38.0309 23.184 38.9669 22.68C39.9029 22.168 41.0429 21.912 42.3869 21.912C43.7309 21.912 44.8669 22.168 45.7949 22.68C46.7309 23.184 47.4829 23.86 48.0509 24.708C48.6269 25.548 49.0429 26.48 49.2989 27.504C49.5629 28.528 49.6949 29.56 49.6949 30.6C49.6949 31.64 49.5629 32.672 49.2989 33.696C49.0429 34.72 48.6269 35.656 48.0509 36.504C47.4829 37.344 46.7309 38.02 45.7949 38.532C44.8669 39.036 43.7309 39.288 42.3869 39.288ZM42.3869 36.3C43.1389 36.3 43.7749 36.124 44.2949 35.772C44.8229 35.42 45.2469 34.96 45.5669 34.392C45.8869 33.824 46.1189 33.208 46.2629 32.544C46.4069 31.872 46.4789 31.224 46.4789 30.6C46.4789 29.928 46.4069 29.256 46.2629 28.584C46.1269 27.904 45.8989 27.288 45.5789 26.736C45.2669 26.176 44.8469 25.728 44.3189 25.392C43.7989 25.048 43.1549 24.876 42.3869 24.876C41.6109 24.876 40.9589 25.052 40.4309 25.404C39.9109 25.756 39.4909 26.22 39.1709 26.796C38.8589 27.364 38.6309 27.984 38.4869 28.656C38.3509 29.32 38.2829 29.968 38.2829 30.6C38.2829 31.264 38.3509 31.932 38.4869 32.604C38.6309 33.276 38.8629 33.892 39.1829 34.452C39.5109 35.012 39.9349 35.46 40.4549 35.796C40.9829 36.132 41.6269 36.3 42.3869 36.3ZM59.5753 39.288C58.1673 39.288 56.9633 39.028 55.9633 38.508C54.9713 37.98 54.2113 37.216 53.6833 36.216C53.1633 35.216 52.9033 34.008 52.9033 32.592V22.2H56.0113V32.592C56.0113 33.864 56.2953 34.8 56.8633 35.4C57.4313 36 58.3353 36.3 59.5753 36.3C60.3593 36.3 61.0153 36.176 61.5433 35.928C62.0713 35.68 62.4673 35.284 62.7313 34.74C62.9953 34.188 63.1273 33.472 63.1273 32.592V22.2H66.2473V32.592C66.2473 33.776 66.0713 34.792 65.7193 35.64C65.3753 36.488 64.8953 37.184 64.2793 37.728C63.6713 38.264 62.9633 38.66 62.1553 38.916C61.3473 39.164 60.4873 39.288 59.5753 39.288ZM70.1092 39V22.2H75.7732C77.2292 22.2 78.4692 22.44 79.4932 22.92C80.5172 23.392 81.3452 24.032 81.9772 24.84C82.6172 25.64 83.0812 26.54 83.3692 27.54C83.6652 28.532 83.8132 29.552 83.8132 30.6C83.8132 31.56 83.6732 32.532 83.3932 33.516C83.1212 34.5 82.6732 35.408 82.0492 36.24C81.4252 37.064 80.5892 37.732 79.5412 38.244C78.5012 38.748 77.2132 39 75.6772 39H70.1092ZM73.2172 36.048H76.0012C76.8572 36.048 77.5772 35.888 78.1612 35.568C78.7452 35.24 79.2132 34.812 79.5652 34.284C79.9252 33.748 80.1852 33.16 80.3452 32.52C80.5132 31.872 80.5972 31.232 80.5972 30.6C80.5972 29.928 80.5132 29.268 80.3452 28.62C80.1772 27.972 79.9172 27.384 79.5652 26.856C79.2132 26.328 78.7652 25.908 78.2212 25.596C77.6772 25.284 77.0252 25.128 76.2652 25.128H73.2172V36.048Z"
                  fill="white"
                />
              </g>
              <defs>
                <clipPath id="clip0_185_319">
                  <rect width="90" height="50" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </NavLink>
          <div className="navbar-links">
            <NavLink to="/services" className="navbar-link">
              {t("navbar.services")}
            </NavLink>
            <NavLink to="/pricing" className="navbar-link">
              {t("navbar.pricing")}
            </NavLink>
            <NavLink to="/docs" className="navbar-link">
              {t("navbar.docs")}
            </NavLink>
          </div>
        </div>
        <div className="navbar-actions">
          <select
            onChange={(e) => i18n.changeLanguage(e.target.value)}
            defaultValue={i18n.resolvedLanguage}
            className="navbar-language"
          >
            {langs.map((lang) => (
              <option
                key={lang.native}
                value={lang.abbr}
                disabled={lang.abbr === i18n.resolvedLanguage}
              >
                {lang.native}
              </option>
            ))}
          </select>
          {auth.isAuth ? (
            <>
              <div className="navbar-action icon" onClick={openSettingsModal}>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="40"
                  height="40"
                  viewBox="0 0 40 40"
                  fill="none"
                >
                  <g clipPath="url(#clip0_130_982)">
                    <path
                      fillRule="evenodd"
                      clipRule="evenodd"
                      d="M30 6.66667C30 6.22464 29.8244 5.80072 29.5118 5.48816C29.1993 5.17559 28.7754 5 28.3333 5C27.8913 5 27.4674 5.17559 27.1548 5.48816C26.8423 5.80072 26.6667 6.22464 26.6667 6.66667V8.33333H6.66667C6.22464 8.33333 5.80072 8.50893 5.48816 8.82149C5.17559 9.13405 5 9.55797 5 10C5 10.442 5.17559 10.866 5.48816 11.1785C5.80072 11.4911 6.22464 11.6667 6.66667 11.6667H26.6667V13.3333C26.6667 13.7754 26.8423 14.1993 27.1548 14.5118C27.4674 14.8244 27.8913 15 28.3333 15C28.7754 15 29.1993 14.8244 29.5118 14.5118C29.8244 14.1993 30 13.7754 30 13.3333V11.6667H33.3333C33.7754 11.6667 34.1993 11.4911 34.5118 11.1785C34.8244 10.866 35 10.442 35 10C35 9.55797 34.8244 9.13405 34.5118 8.82149C34.1993 8.50893 33.7754 8.33333 33.3333 8.33333H30V6.66667ZM6.66667 18.3333C6.22464 18.3333 5.80072 18.5089 5.48816 18.8215C5.17559 19.134 5 19.558 5 20C5 20.442 5.17559 20.8659 5.48816 21.1785C5.80072 21.4911 6.22464 21.6667 6.66667 21.6667H10V23.3333C10 23.7754 10.1756 24.1993 10.4882 24.5118C10.8007 24.8244 11.2246 25 11.6667 25C12.1087 25 12.5326 24.8244 12.8452 24.5118C13.1577 24.1993 13.3333 23.7754 13.3333 23.3333V21.6667H33.3333C33.7754 21.6667 34.1993 21.4911 34.5118 21.1785C34.8244 20.8659 35 20.442 35 20C35 19.558 34.8244 19.134 34.5118 18.8215C34.1993 18.5089 33.7754 18.3333 33.3333 18.3333H13.3333V16.6667C13.3333 16.2246 13.1577 15.8007 12.8452 15.4882C12.5326 15.1756 12.1087 15 11.6667 15C11.2246 15 10.8007 15.1756 10.4882 15.4882C10.1756 15.8007 10 16.2246 10 16.6667V18.3333H6.66667ZM5 30C5 29.558 5.17559 29.134 5.48816 28.8215C5.80072 28.5089 6.22464 28.3333 6.66667 28.3333H26.6667V26.6667C26.6667 26.2246 26.8423 25.8007 27.1548 25.4882C27.4674 25.1756 27.8913 25 28.3333 25C28.7754 25 29.1993 25.1756 29.5118 25.4882C29.8244 25.8007 30 26.2246 30 26.6667V28.3333H33.3333C33.7754 28.3333 34.1993 28.5089 34.5118 28.8215C34.8244 29.134 35 29.558 35 30C35 30.442 34.8244 30.866 34.5118 31.1785C34.1993 31.4911 33.7754 31.6667 33.3333 31.6667H30V33.3333C30 33.7754 29.8244 34.1993 29.5118 34.5118C29.1993 34.8244 28.7754 35 28.3333 35C27.8913 35 27.4674 34.8244 27.1548 34.5118C26.8423 34.1993 26.6667 33.7754 26.6667 33.3333V31.6667H6.66667C6.22464 31.6667 5.80072 31.4911 5.48816 31.1785C5.17559 30.866 5 30.442 5 30Z"
                      fill="black"
                    />
                  </g>
                  <defs>
                    <clipPath id="clip0_130_982">
                      <rect width="40" height="40" fill="white" />
                    </clipPath>
                  </defs>
                </svg>
              </div>
              <div
                className="navbar-action icon"
                onClick={() => dispatch(logOut())}
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="40"
                  height="40"
                  viewBox="0 0 40 40"
                  fill="none"
                >
                  <path
                    d="M33.3334 10H30V6.66667L10 6.66667L10 33.3333H30V30H33.3334V35C33.3334 35.442 33.1578 35.866 32.8452 36.1785C32.5327 36.4911 32.1087 36.6667 31.6667 36.6667L8.33337 36.6667C7.89135 36.6667 7.46742 36.4911 7.15486 36.1785C6.8423 35.866 6.66671 35.442 6.66671 35L6.66671 5C6.66671 4.55797 6.8423 4.13405 7.15486 3.82149C7.46742 3.50893 7.89135 3.33333 8.33337 3.33333L31.6667 3.33333C32.1087 3.33333 32.5327 3.50893 32.8452 3.82149C33.1578 4.13405 33.3334 4.55797 33.3334 5V10ZM30 21.6667H18.3334V18.3333L30 18.3333L30 13.3333L38.3334 20L30 26.6667V21.6667Z"
                    fill="black"
                  />
                </svg>
              </div>
            </>
          ) : (
            <div className="navbar-action" onClick={openSignInModal}>
              <div className="icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="40"
                  height="40"
                  viewBox="0 0 40 40"
                  fill="none"
                >
                  <path
                    d="M6.66665 25H9.99998V33.3333H30V6.66667H9.99998V15H6.66665V5C6.66665 4.55797 6.84224 4.13405 7.1548 3.82149C7.46736 3.50893 7.89129 3.33333 8.33331 3.33333H31.6666C32.1087 3.33333 32.5326 3.50893 32.8452 3.82149C33.1577 4.13405 33.3333 4.55797 33.3333 5V35C33.3333 35.442 33.1577 35.866 32.8452 36.1785C32.5326 36.4911 32.1087 36.6667 31.6666 36.6667H8.33331C7.89129 36.6667 7.46736 36.4911 7.1548 36.1785C6.84224 35.866 6.66665 35.442 6.66665 35V25ZM16.6666 18.3333V13.3333L25 20L16.6666 26.6667V21.6667H3.33331V18.3333H16.6666Z"
                    fill="black"
                  />
                </svg>
              </div>
            </div>
          )}
        </div>
      </div>
    </nav>
  );
};

export default Navbar;
